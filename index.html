<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Vanishing Numbers</title>
    <style>
      * {
        padding: 0;
        margin: 0;
      }
      canvas {
        background: #eee;
        display: block;
        margin: 0 0;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="800" height="600"></canvas>

    <script>
      // JavaScript code goes here
      const COLOR_ARR = [
        "#A3E4D7",
        "#EBDEF0",
        "#FCF3CF",
        "#E5E7E9",
        "#AEB6BF",
        "#839192",
        "#E6B0AA",
        "#7FB3D5",
        "#EDBB99",
        "#D2B4DE"
      ];
      const BACKGROUND_COLOR = "#EEE";
      const TEXT_COLOR = "#FFFFFF";
      const TEXT_FONT = "30px Arial";
      const SQR_SIZE = 50;
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");

      const draw_sqr = function(
        x,
        y,
        size = SQR_SIZE,
        fillColor = BACKGROUND_COLOR
      ) {
        ctx.beginPath();
        ctx.rect(x, y, size, size);
        ctx.fillStyle = fillColor;
        ctx.fill();
        // ctx.closePath();
      };

      const randomIn10 = function() {
        return Math.floor(Math.random() * 10);
      };

      const randomIn100 = function() {
        return Math.floor(Math.random() * 100);
      };
      const findOrigin = function(num) {
        //find the highest closest multiple of 50 thats less than this num
        return num - (num % 50);
      };

      var i = 0;
      var j = 0;
      var height_arr = [];
      for (let m = 0; m < 40; m++) {
        height_arr[m] = 600;
      }
      var column = [];
      for (let n = 0; n < 16; n++) {
        column[n] = [];
      }
      var color_choice = COLOR_ARR[randomIn10()];
      var txt = parseInt(randomIn10(), 10);

      const draw = function() {
        //Delete the old square
        draw_sqr(i, j - 5); //default is background color

        //Redraw the square at the new position
        draw_sqr(i, j, SQR_SIZE, color_choice);

        ctx.fillStyle = TEXT_COLOR;
        ctx.font = TEXT_FONT;
        ctx.fillText(txt, i + 10, j + 25);

        if (j == height_arr[i / 50] - 50) {
          height_arr[i / 50] -= 50;
          column[i / 50].push([txt, color_choice]);
          console.log("Column[", i / 50, "]: ", column[i / 50]);
          i = (randomIn100() % 16) * 50;
          j = 0;
          let color_ind = randomIn10();
          color_choice = COLOR_ARR[color_ind];
          txt = parseInt(randomIn10(), 10);
        }
        j += 5;
      };
      canvas.addEventListener(
        "click",
        function(e) {
          ctx.beginPath();
          x = findOrigin(e.clientX);
          y = findOrigin(e.clientY);
          //console.log("e.clientX: ", e.clientX, "e.clientY: ", e.clientY);
          console.log("X: ", x, "Y: ", y);
          col = x / 50;
          row = 11 - y / 50;
          column[col] = column[col]
            .slice(0, row)
            .concat(column[col].slice(row + 1));
          console.log("After delete Column[", col, "]: ", column[col]);
          column[col].forEach((sqr, ind) => {
            draw_sqr(col * 50, 550 - ind * 50, SQR_SIZE, sqr[1]);
            ctx.fillStyle = TEXT_COLOR;
            ctx.fillText(sqr[0], col * 50 + 10, 550 - ind * 50 + 25);
          });

          new_rows = column[col].length;
          draw_sqr(col * 50, 550 - new_rows * 50, SQR_SIZE, BACKGROUND_COLOR);
          height_arr[col] += 50;

          // draw_sqr(x, y);
        },
        false
      );

      setInterval(draw, 10);
    </script>
  </body>
</html>
